# Sueta Telegram Bot

Telegram-–±–æ—Ç –Ω–∞ Go 1.24, –∫–æ—Ç–æ—Ä—ã–π –≤–µ–¥—ë—Ç –æ—Å–º—ã—Å–ª–µ–Ω–Ω—ã–π –¥–∏–∞–ª–æ–≥ –∏ —Ö—Ä–∞–Ω–∏—Ç –ø–∞–º—è—Ç—å –≤ MongoDB. –ë–æ—Ç —É–º–µ–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è, –∞–¥—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã–µ –∫ –Ω–µ–º—É –ø–æ –∏–º–µ–Ω–∏, –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π.

## ‚ú® –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ü§ñ **–û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π**: –ë–æ—Ç —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –µ–≥–æ –∏–º—è "–¢–æ–ª–∏–∫"
- üß† **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è –ø–∞–º—è—Ç—å**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –¥–Ω—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤
- üöÄ **LLM –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç OpenRouter API –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —É–º–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
- üíæ **–ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ**: –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ MongoDB —Å TTL –∏–Ω–¥–µ–∫—Å–æ–º
- ‚ö° **Webhook –ø–æ–¥–¥–µ—Ä–∂–∫–∞**: –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Ö–æ–¥—è—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è —á–µ—Ä–µ–∑ HTTP webhook

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**
```bash
git clone https://github.com/semyon-ancherbak/sueta.git
cd sueta
```

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª, –¥–æ–±–∞–≤–∏–≤ –≤–∞—à–∏ —Ç–æ–∫–µ–Ω—ã –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```

3. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
```bash
go mod tidy
```

4. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:**
```bash
go run ./cmd/bot
```

–ë–æ—Ç –±—É–¥–µ—Ç –∑–∞–ø—É—â–µ–Ω –Ω–∞ –ø–æ—Ä—Ç—É 8080. Webhook endpoint: `http://localhost:8080/webhook`

### –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

```bash
# –°–æ–∑–¥–∞–π—Ç–µ .env —Ñ–∞–π–ª —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
cp .env.example .env

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —á–µ—Ä–µ–∑ docker-compose
docker-compose up --build
```

## üìù –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ webhook

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è webhook –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å curl:

```bash
curl -X POST http://localhost:8080/webhook \
  -H "Content-Type: application/json" \
  -d '{
    "update_id": 123456789,
    "message": {
      "message_id": 1,
      "from": {
        "id": 123456,
        "is_bot": false,
        "first_name": "Test",
        "username": "testuser"
      },
      "chat": {
        "id": 123456,
        "type": "private"
      },
      "date": 1640995200,
      "text": "–ü—Ä–∏–≤–µ—Ç, –±–æ—Ç!"
    }
  }'
```

## üß™ –¢–µ—Å—Ç—ã

–ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —Ç–µ—Å—Ç–æ–≤:
```bash
go test ./...
```

–ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤ —Å –ø–æ–¥—Ä–æ–±–Ω—ã–º –≤—ã–≤–æ–¥–æ–º:
```bash
go test -v ./...
```

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
‚îú‚îÄ‚îÄ cmd/bot/              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ internal/             # –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ handler/          # HTTP/Telegram webhook handlers
‚îÇ   ‚îú‚îÄ‚îÄ memory/           # –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ (TODO)
‚îÇ   ‚îú‚îÄ‚îÄ llm/              # –û–±—ë—Ä—Ç–∫–∞ –¥–ª—è LLM –∑–∞–ø—Ä–æ—Å–æ–≤ (TODO)
‚îÇ   ‚îî‚îÄ‚îÄ config/           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ pkg/                  # –ü—É–±–ª–∏—á–Ω—ã–µ –ø–∞–∫–µ—Ç—ã (TODO)
‚îú‚îÄ‚îÄ Dockerfile            # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ docker-compose.yml    # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ .env.example          # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–¥–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|------------|----------|----------------------|
| `PORT` | –ü–æ—Ä—Ç HTTP —Å–µ—Ä–≤–µ—Ä–∞ | `8080` |
| `TELEGRAM_TOKEN` | –¢–æ–∫–µ–Ω Telegram –±–æ—Ç–∞ | - |
| `WEBHOOK_URL` | URL –¥–ª—è webhook | - |
| `MONGO_URL` | URL MongoDB | `mongodb://localhost:27017` |
| `MONGO_DATABASE` | –ò–º—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö | `sueta` |
| `OPENROUTER_API_KEY` | –ö–ª—é—á OpenRouter API | - |

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–¢–µ–∫—É—â–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ webhook –æ—Ç Telegram
- ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ —Å–æ–æ–±—â–µ–Ω–∏–π  
- ‚úÖ –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π, –∞–¥—Ä–µ—Å–æ–≤–∞–Ω–Ω—ã—Ö –±–æ—Ç—É
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LLM (OpenRouter API)
- ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–æ–≤ –≤ Telegram
- ‚úÖ HTTP —Å–µ—Ä–≤–µ—Ä —Å middleware
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å MongoDB
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —á–∞—Ç–æ–≤ (–±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ MongoDB
- ‚úÖ –ë–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã –∏ mock repository
- ‚úÖ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è
- ‚úÖ Graceful shutdown

–ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è:
- [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LLM (OpenRouter)
- [ ] –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤
- [ ] –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–±—Ä–∞—Ç–Ω–æ –≤ Telegram
- [ ] –°–∏—Å—Ç–µ–º–∞ long-term –ø–∞–º—è—Ç–∏

## üìã TODO

- [ ] –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è –ø–∞–º—è—Ç–∏ (`internal/memory/`)
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å MongoDB store —Å TTL –∏–Ω–¥–µ–∫—Å–∞–º–∏
- [ ] –î–æ–±–∞–≤–∏—Ç—å LLM –∫–ª–∏–µ–Ω—Ç (`internal/llm/`)
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Telegram API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
- [ ] –î–æ–±–∞–≤–∏—Ç—å CI/CD pipeline
- [ ] –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ —Ç–µ—Å—Ç–æ–≤

## üéØ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–æ—Ç–∞

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram –±–æ—Ç–∞

1. **–°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram:**
   - –ù–∞–ø–∏—à–∏—Ç–µ @BotFather –≤ Telegram
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
   - –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –∏ –ø–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω

2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ webhook:**
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ ngrok –∏–ª–∏ –ø–æ–¥–æ–±–Ω—ã–π —Å–µ—Ä–≤–∏—Å –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
   - –ò–ª–∏ —Ä–∞–∑–≤–µ—Ä–Ω–∏—Ç–µ –Ω–∞ –ø—É–±–ª–∏—á–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ

### –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –±–æ—Ç–æ–º

–ë–æ—Ç —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –µ–≥–æ –∏–º—è **"–¢–æ–ª–∏–∫"**:

- ‚úÖ "–¢–æ–ª–∏–∫, –∫–∞–∫ –¥–µ–ª–∞?" - –±–æ—Ç –æ—Ç–≤–µ—Ç–∏—Ç
- ‚úÖ "–ü—Ä–∏–≤–µ—Ç –¢–æ–ª–∏–∫!" - –±–æ—Ç –æ—Ç–≤–µ—Ç–∏—Ç  
- ‚úÖ "–≠–π —Ç–æ–ª–∏–∫ —Ä–∞—Å—Å–∫–∞–∂–∏ –∞–Ω–µ–∫–¥–æ—Ç" - –±–æ—Ç –æ—Ç–≤–µ—Ç–∏—Ç (—Ä–µ–≥–∏—Å—Ç—Ä –Ω–µ –≤–∞–∂–µ–Ω)
- ‚ùå "–ü—Ä–∏–≤–µ—Ç –≤—Å–µ–º!" - –±–æ—Ç –Ω–µ –æ—Ç–≤–µ—Ç–∏—Ç

–ë–æ—Ç —É—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 3 –¥–Ω–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–∞.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OpenRouter

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ [OpenRouter.ai](https://openrouter.ai/)
2. –ü–æ–ª—É—á–∏—Ç–µ API –∫–ª—é—á
3. –î–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `OPENROUTER_API_KEY`

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥–µ–ª—å `anthropic/claude-3.5-sonnet`.
